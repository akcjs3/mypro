<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Monitor Sketcher Â· ê²€ì‚¬</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="/static/css/style.css" />
  <!-- Chart.js (ì›ê·¸ë˜í”„ + ì‹œê°„ë³„ ì°¨íŠ¸ìš©) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  

  <!-- ê²°ê³¼ ë·° ì „ìš© ê°„ë‹¨ ìŠ¤íƒ€ì¼ (ì›í•˜ë©´ style.cssë¡œ ì˜®ê²¨ë„ ë¨) -->
  <style>
/* ==============================
   âœ… ê²€ì‚¬ ê²°ê³¼ ë·° ìµœì¢… ìŠ¤íƒ€ì¼ (ì¤‘ë³µ/ì¶©ëŒ ì œê±°íŒ)
   ============================== */

/* ê²°ê³¼ ëª¨ë“œ hero-card: í™”ë©´ ì¤‘ì•™ + ì ë‹¹íˆ ì‘ì€ í­ */
.hero-card.result-mode {
  min-height: auto;
  max-width: 760px;
  width: 70%;
  margin: 0 auto;              /* âœ… hero ìì²´ ì¤‘ì•™ */
  padding: 2.2rem 2rem;
  position: relative;          /* âœ… left/transform ê¸ˆì§€ */
  left: auto;
  transform: none;
}

/* ê²°ê³¼ ì˜ì—­ ì „ì²´ */
.test-result {
  margin-top: 1.6rem;
  animation: ms-result-fade-in 0.35s ease-out;
}

/* A/B ì ˆë°˜ ê·¸ë¦¬ë“œ + ê° ì¹¸ ê¸°ì¤€ ì¤‘ì•™ì •ë ¬ */
.test-result-grid {
  display: grid;
  grid-template-columns: 1fr 1fr; /* âœ… ì •í™•íˆ ë°˜ë°˜ */
  gap: 1.6rem;
  align-items: start;
  justify-items: center;          /* âœ… ì¹¸ ì•ˆì—ì„œ ì¤‘ì•™ */
}

/* ---------- ì™¼ìª½(A) ---------- */
.test-result-left {
  width: 100%;
  max-width: 340px;               /* âœ… ì™¼ìª½ ì¹¸ ê¸°ì¤€ ë„ˆë¹„ ì œí•œ */
  text-align: center;
  justify-self: center;
}

/* ìƒë‹¨ ì œëª©/ìš”ì•½: ì™¼ìª½ ì¹¸ ê¸°ì¤€ ì •ì¤‘ì•™ */
.test-result-title,
.test-result-summary {
  text-align: center;
}

.test-result-title {
  font-size: 1.25rem;
  font-weight: 700;
  margin-bottom: 0.6rem;
}

.test-result-summary {
  font-size: 0.95rem;
  line-height: 1.6;
  color: rgba(230, 230, 255, 0.94);
}

/* í†µê³„ 4ê°œ + ë§ˆì´í˜ì´ì§€ ì„¸ë¡œ ìŠ¤íƒ (ëª¨ë‘ ê°™ì€ í¬ê¸°) */
.test-result-focus {
  margin-top: 1.1rem;
  display: flex;
  flex-direction: column;
  gap: 0.7rem;
  align-items: center;
  width: 100%;
}

.test-result-stat {
  width: 100%;
  max-width: 300px;          /* âœ… ì „ë¶€ ë™ì¼ í­ */
  min-width: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 0.6rem 1rem;      /* âœ… í¬ê¸° ì•½ê°„ ì¶•ì†Œ */
  border-radius: 18px;
  background: rgba(10, 10, 35, 0.9);
  border: 1px solid rgba(130, 130, 210, 0.5);
  box-shadow: 0 4px 14px rgba(0, 0, 0, 0.6);
  text-align: center;
}

.test-result-stat .label {
  display: block;
  font-size: 0.75rem;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  color: rgba(185, 185, 235, 0.95);
}

.test-result-stat .value {
  display: block;
  margin-top: 0.12rem;
  font-size: 1.05rem;
  font-weight: 700;
  color: #ffffff;
}

/* ë§ˆì´í˜ì´ì§€ ë²„íŠ¼: í†µê³„ì™€ ë™ì¼ í¬ê¸° + ìƒ‰ë§Œ ë‹¤ë¥´ê²Œ */
.test-result-actions {
  margin-top: 0.2rem;
  width: 100%;
  display: flex;
  justify-content: center;
}

.test-result-orb {
  width: 100%;
  max-width: 300px;      /* âœ… í†µê³„ ë°•ìŠ¤ì™€ ë™ì¼ */
  height: auto;
  padding: 0.6rem 1rem;
  border-radius: 18px;
  border: 1px solid rgba(255, 255, 255, 0.35);
  background: radial-gradient(circle at top left, #262650, #090919);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.9rem;
  font-weight: 700;
  color: rgba(235, 235, 255, 0.9);
  letter-spacing: 0.05em;
  cursor: pointer;
  position: static;
  opacity: 1;
  pointer-events: auto;
  transform: none;
  transition: background 0.2s ease, box-shadow 0.2s ease, transform 0.15s ease;
}

/* âœ… ë§ˆì´í˜ì´ì§€ ë²„íŠ¼ ìƒ‰ë§Œ ê°•ì¡° */
#goMyPageBtn.test-result-orb {
  background: linear-gradient(135deg, #3b3593, #47288c);
  border: 1px solid rgba(190, 170, 255, 0.9);
  box-shadow: 0 10px 26px rgba(90, 70, 255, 0.55);
  color: #fff;
}

.test-result-orb:hover {
  background: radial-gradient(circle at top left, #303060, #0b0b1f);
  transform: translateY(-2px);
  box-shadow: 0 14px 34px rgba(0, 0, 0, 0.9);
}

#goMyPageBtn.test-result-orb:hover {
  filter: brightness(1.08);
}

/* ---------- ì˜¤ë¥¸ìª½(B) ---------- */
.test-result-right {
  width: 100%;
  max-width: 360px;               /* âœ… ì˜¤ë¥¸ìª½ ì¹¸ ê¸°ì¤€ ë„ˆë¹„ ì œí•œ */
  justify-self: center;
}

.test-chart-wrapper {
  width: 100%;
  display: grid;
  gap: 1.2rem;
  justify-items: center;          /* âœ… ì°¨íŠ¸ ë¸”ë¡ë„ ì¹¸ ì¤‘ì•™ */
}

.chart-block {
  width: 100%;
  max-width: 360px;
  min-width: 0;
  background: rgba(8, 10, 25, 0.95);
  border: 1px solid rgba(120, 120, 200, 0.5);
  border-radius: 16px;
  padding: 1rem;
  box-shadow: 0 4px 18px rgba(0, 0, 0, 0.7);
}

.chart-title {
  font-size: 0.95rem;
  font-weight: 700;
  margin-bottom: 0.7rem;
  text-align: center;             /* âœ… ì˜¤ë¥¸ìª½ ì¹¸ ê¸°ì¤€ ì¤‘ì•™ */
  color: rgba(235, 235, 255, 0.96);
}

/* ì°¨íŠ¸ í¬ê¸°: heroë¥¼ ê½‰ ì±„ìš°ì§€ ì•Šê²Œ */
.test-chart-wrapper canvas {
  width: 100% !important;
  height: 210px !important;
}

/* ëª¨ë°”ì¼ */
@media (max-width: 960px) {
  .hero-card.result-mode {
    max-width: 720px;
    width: 95%;
  }
  .test-result-grid {
    grid-template-columns: 1fr;
  }
  .test-result-left,
  .test-result-right {
    max-width: 100%;
  }
  .test-chart-wrapper canvas {
    height: 200px !important;
  }
}

/* animation */
@keyframes ms-result-fade-in {
  from { opacity: 0; transform: translateY(4px); }
  to   { opacity: 1; transform: translateY(0); }
}
/* A ì˜ì—­ ìƒë‹¨ ì œëª©/ìš”ì•½ë§Œ í™•ì‹¤íˆ ê°€ìš´ë°ë¡œ */
.test-result-left .test-result-title,
.test-result-left .test-result-summary {
  width: 100%;
  text-align: center !important;
}


  </style>
</head>
<body>
  <div class="app">
    <!-- ìƒë‹¨ í—¤ë” (indexì™€ ë™ì¼ êµ¬ì¡°) -->
    <header class="site-header">
      <div class="header-inner">
        <!-- ì™¼ìª½ ë¡œê³  + í…ìŠ¤íŠ¸ -->
        <a href="/index.html" class="brand">
    <div class="brand-logo-mark">
        <img src="./src/logo.png" />
    </div>
    <span class="brand-text">Monitor Sketcher</span>
</a>

        <!-- ê°€ìš´ë° ë„¤ë¹„ê²Œì´ì…˜ -->
        <nav class="main-nav">
          <a href="test.html" class="nav-link" data-page="test">ê²€ì‚¬</a>
          <a href="ranking.html" class="nav-link" data-page="ranking">ë­í‚¹</a>
          <a href="about.html" class="nav-link" data-page="about">ì†Œê°œ</a>
          <a href="contact.html" class="nav-link" data-page="contact">ë¬¸ì˜</a>
        </nav>

        <!-- ì˜¤ë¥¸ìª½ ë¡œê·¸ì¸ / ë§ˆì´í˜ì´ì§€ / ë¡œê·¸ì•„ì›ƒ -->
        <div class="header-actions">
          <span id="user-nickname-label" class="nickname-label hidden"></span>

          <button id="mypage-btn" class="header-btn outline-btn hidden">
            ë§ˆì´í˜ì´ì§€
          </button>

          <button id="login-btn" class="header-btn primary-btn">
            ë¡œê·¸ì¸
          </button>
          <button id="logout-btn" class="header-btn outline-btn hidden">
            ë¡œê·¸ì•„ì›ƒ
          </button>
        </div>
      </div>
    </header>

    <!-- ë©”ì¸ íˆì–´ë¡œ ì˜ì—­ (ê²€ì‚¬ í˜ì´ì§€ìš©) -->
    <main class="hero">
      <section class="hero-card">
        <div class="hero-glow"></div>

        <!-- âœ… ì²˜ìŒ ë³´ì´ëŠ” í™”ë©´ -->
        <div class="hero-content hero-content-initial">
          <h1 class="hero-title">Monitor Sketcher</h1>
          <p class="hero-subtitle">
            ì§€ê¸ˆ PC ì‚¬ìš© ê¸°ë¡ì„ ì§§ê²Œ ì¸¡ì •í•´ì„œ,<br />
            ë‚´ê°€ ì •ë§ë¡œ ì–´ë””ì— ì‹œê°„ì„ ì“°ê³  ìˆëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”.
          </p>

          <div class="test-main-actions">
            <button id="start-test-view-btn" class="test-main-btn">
              ê²€ì‚¬í•˜ê¸°
            </button>
          </div>
        </div>

        <!-- âœ… ê²€ì‚¬ ì„¤ì • í™”ë©´ (ê²€ì‚¬í•˜ê¸° ëˆŒë €ì„ ë•Œ ë‚˜íƒ€ë‚˜ëŠ” í™”ë©´) -->
        <div class="hero-content test-setup hidden">
          <div class="test-layout">
                    <!-- ì™¼ìª½: ë‹‰ë„¤ì„ + ì‘ì—… ì„ íƒ -->
        <div class="test-left">
          <h2 class="test-title">
            <span id="test-greeting-name">ì‚¬ìš©ì</span>ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤.
          </h2>
          <p class="test-subtitle">
            ë‹¹ì‹ ì˜ ì‘ì—…ì„ ì„ íƒí•´ì£¼ì„¸ìš”.
          </p>

          <div class="test-checkboxes">
            <label class="test-check-item">
              <input type="radio" name="task" value="study" />
              <span class="check-label-main">Study</span>
              <span class="check-label-sub">(ì‘ì—… / ê³µë¶€)</span>
            </label>

            <label class="test-check-item">
              <input type="radio" name="task" value="webtoon" />
              <span class="check-label-main">Webtoon</span>
              <span class="check-label-sub">(ë§Œí™”)</span>
            </label>

            <label class="test-check-item">
              <input type="radio" name="task" value="game" />
              <span class="check-label-main">Game</span>
              <span class="check-label-sub">(ê²Œì„)</span>
            </label>

            <label class="test-check-item">
              <input type="radio" name="task" value="youtube-music" />
              <span class="check-label-main">Music</span>
              <span class="check-label-sub">(ìŒì•…)</span>
            </label>

            <label class="test-check-item">
              <input type="radio" name="task" value="youtube" />
              <span class="check-label-main">YouTube</span>
              <span class="check-label-sub">(ë¹„ë””ì˜¤)</span>
            </label>

            <label class="test-check-item">
              <input type="radio" name="task" value="sns" />
              <span class="check-label-main">SNS</span>
              <span class="check-label-sub">(ë©”ì‹ ì €)</span>
            </label>
          </div>

          <!-- âœ… ì„ íƒ ì™„ë£Œ ë²„íŠ¼ -->
          <button id="task-confirm-btn" class="task-confirm-btn">
            ì„ íƒ ì™„ë£Œ
          </button>
        </div>

            <!-- ì˜¤ë¥¸ìª½: íƒ€ì´ë¨¸ + ê²€ì‚¬ ì‹œì‘/ì¢…ë£Œ ë²„íŠ¼ -->
            <div class="test-right">
              <div class="test-timer-label">
                ê²€ì‚¬ê°€ <span id="test-countdown">10</span>ì´ˆ í›„ ì‹œì‘ë©ë‹ˆë‹¤.
              </div>

              <div class="test-timer-display">
                <span id="test-timer-big">10:00</span>
              </div>

              <!-- ê²€ì‚¬ ì¤‘ í‘œì‹œ -->
              <div id="test-running" class="test-running hidden">
                <span class="test-running-dot"></span>
                <span class="test-running-text">ê²€ì‚¬ ì¤‘...</span>
              </div>

              <div class="test-controls">
                <button
                  id="test-start-btn"
                  class="test-ctrl-btn primary"
                  type="button"
                >
                  ê²€ì‚¬ ì‹œì‘
                </button>
                <button
                  id="test-stop-btn"
                  class="test-ctrl-btn secondary"
                  type="button"
                  disabled
                >
                  ê²€ì‚¬ ì¢…ë£Œ
                </button>
              </div>

              <p class="test-note">
                â€» ê²€ì‚¬ ì‹œì‘ í›„, ì•½ 10ì´ˆ ë’¤ë¶€í„° PC í™”ë©´ê³¼ í‚¤ë³´ë“œ/ë§ˆìš°ìŠ¤ ì…ë ¥ì„ ê¸°ë¡í•©ë‹ˆë‹¤.
              </p>
            </div>
          </div>
        </div>

        <!-- âœ… ê²€ì‚¬ ê²°ê³¼ í™”ë©´ -->
        <div class="hero-content test-result hidden">
          <div class="test-result-grid">
           <div class="test-result-left">
  <!-- ğŸ”¹ ìƒë‹¨ 3ì¤„: ë‹‰ë„¤ì„ / ì´ë²ˆ ì„¸ì…˜ ìš”ì•½ / ì„ íƒí•œ ì‘ì—… -->
  <h2 class="test-result-title">
    <span id="test-result-nickname">ì‚¬ìš©ì</span>ë‹˜ì´ ì‹¤í–‰
  </h2>
  <h2 class="test-result-title">ì´ë²ˆ ì„¸ì…˜ ìš”ì•½</h2>
  <h2 class="test-result-title">
    ì„ íƒ ì‘ì—…:
    <span id="test-result-selected-task">-</span>
  </h2>

  <!-- ğŸ”¹ ìš”ì•½ ë¬¸êµ¬ -->
  <p id="test-result-summary" class="test-result-summary">
    ê²€ì‚¬ ì¢…ë£Œ í›„, ì´ê³³ì— ë¶„ì„ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.
  </p>
  <p id="test-result-detail" class="test-result-summary">
   
  </p>

  <!-- ğŸ”¹ í•˜ë‹¨ í†µê³„ 4ê°œ (ëª¨ë‘ ê°™ì€ ë„í˜• í¬ê¸°) -->
  <div class="test-result-focus">
    <div class="test-result-stat">
      <span class="label">ì§‘ì¤‘ë„ (ì„ íƒí•œ ì‘ì—… ê¸°ì¤€)</span>
      <span id="test-focus-percent" class="value">--%</span>
    </div>

    <div class="test-result-stat">
      <span class="label">ì ìˆ˜ ì‹œê°„ ë¹„ìœ¨</span>
      <span id="test-idle-percent" class="value">--%</span>
    </div>

    <div class="test-result-stat">
      <span class="label">ì…ë ¥/ë¶„ (í‚¤ë³´ë“œ+ë§ˆìš°ìŠ¤)</span>
      <span id="test-input-per-min" class="value">--</span>
    </div>

    <div class="test-result-stat">
      <span class="label">ê¸°ë¡ëœ í™”ë©´ (ì´ ìº¡ì³ ìˆ˜)</span>
      <span id="test-capture-count" class="value">--</span>
</div>

<div class="test-result-actions">
  <button id="goMyPageBtn" class="test-result-orb" type="button">
    ë§ˆì´í˜ì´ì§€
  </button>
  </div>
  </div>
</div>

            <!-- ì˜¤ë¥¸ìª½: ì°¨íŠ¸ 2ê°œ -->
            <div class="test-result-right">
              <div class="test-chart-wrapper">
                <div class="chart-block">
                  <h3 class="chart-title">í™œë™ ë¹„ìœ¨ (ì „ì²´ ì„¸ì…˜)</h3>
                  <canvas id="activity-pie"></canvas>
                </div>

                <div class="chart-block">
                  <h3 class="chart-title">ì‹œê°„ëŒ€ë³„ í™œë™ ìœ í˜•</h3>
                  <canvas id="activity-timeline"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- âœ… ê²€ì‚¬ í˜ì´ì§€ìš© 'êµ¬' ë²„íŠ¼ -->
    <button id="test-orb" class="about-orb test-orb" type="button">
      ëŒì•„ê°€ê¸°
    </button>

    <!-- í‘¸í„° -->
    <footer class="footer">
      <span>ì¡¸ì—… ì‘í’ˆ Â· Monitor Sketcher Â· PC ì‚¬ìš© ê¸°ë¡ ê¸°ë°˜ ì§‘ì¤‘ë„ ë¶„ì„ ì„œë¹„ìŠ¤</span>
    </footer>
  </div>

  <!-- ë¡œê·¸ì¸ í•„ìš” íŒì—… ëª¨ë‹¬ (indexì™€ ë™ì¼) -->
  <div id="login-modal-backdrop" class="login-modal-backdrop hidden">
    <div class="login-modal">
      <h3 class="login-modal-title">ë¡œê·¸ì¸ì´ í•„ìš”í•œ ê¸°ëŠ¥ì…ë‹ˆë‹¤</h3>
      <p class="login-modal-message">
        ì´ ê¸°ëŠ¥ì„ ì´ìš©í•˜ë ¤ë©´ ë¨¼ì € ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”.
      </p>
      <div class="login-modal-actions">
        <button
          type="button"
          id="login-modal-cancel"
          class="login-modal-btn login-modal-btn-secondary"
        >
          ì·¨ì†Œ
        </button>
        <button
          type="button"
          id="login-modal-go"
          class="login-modal-btn login-modal-btn-primary"
        >
          ë¡œê·¸ì¸ í•˜ëŸ¬ ê°€ê¸°
        </button>
      </div>
    </div>
  </div>

  <!-- ê³µí†µ JS -->

  <!-- ê²€ì‚¬ í˜ì´ì§€ ì „ìš© JS -->
  <script>

    // âœ… test.html ì „ìš© ë¡œê·¸ì¸ ìœ ì§€ í•¨ìˆ˜ (main.jsì—ì„œ ê°€ì ¸ì˜¨ ê·¸ëŒ€ë¡œ)
function getCurrentUser() {
  try {
    const raw = localStorage.getItem("ms_user");
    if (!raw) return null;
    return JSON.parse(raw);
  } catch (e) {
    console.error("ms_user íŒŒì‹± ì˜¤ë¥˜:", e);
    return null;
  }
}

    // =============================
// âœ… test.html ì „ìš©: í—¤ë” ë¡œê·¸ì¸ UI ë™ê¸°í™”
// =============================
function syncAuthUI() {
  const loginBtn = document.getElementById("login-btn");
  const logoutBtn = document.getElementById("logout-btn");
  const mypageBtn = document.getElementById("mypage-btn");
  const nicknameLabel = document.getElementById("user-nickname-label");

  const user = getCurrentUser(); // ë„¤ê°€ ì¶”ê°€í•œ ê·¸ í•¨ìˆ˜

  if (user) {
    // ë¡œê·¸ì¸ ìƒíƒœ
    loginBtn?.classList.add("hidden");
    logoutBtn?.classList.remove("hidden");
    mypageBtn?.classList.remove("hidden");
    if (nicknameLabel) {
      nicknameLabel.classList.remove("hidden");
      nicknameLabel.textContent = user.nickname ? `${user.nickname}ë‹˜` : "";
    }
  } else {
    // ë¡œê·¸ì•„ì›ƒ ìƒíƒœ
    loginBtn?.classList.remove("hidden");
    logoutBtn?.classList.add("hidden");
    mypageBtn?.classList.add("hidden");
    if (nicknameLabel) {
      nicknameLabel.classList.add("hidden");
      nicknameLabel.textContent = "";
    }
  }
}

document.addEventListener("DOMContentLoaded", () => {
  syncAuthUI();

  // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ë™ì‘ë„ testì—ì„œ ì²˜ë¦¬
  document.getElementById("logout-btn")?.addEventListener("click", () => {
    localStorage.removeItem("ms_user");
    syncAuthUI();
    window.location.href = "/"; // ë©”ì¸ìœ¼ë¡œ
  });

  // ë§ˆì´í˜ì´ì§€ ì´ë™
  document.getElementById("mypage-btn")?.addEventListener("click", () => {
    window.location.href = "/mypage.html";
  });

  // ë¡œê·¸ì¸ ì´ë™
  document.getElementById("login-btn")?.addEventListener("click", () => {
    window.location.href = "/login.html";
  });
});

    
    document.addEventListener("DOMContentLoaded", () => {
      console.log("[test] ê²€ì‚¬ í˜ì´ì§€ ìŠ¤í¬ë¦½íŠ¸ ë¡œë”©ë¨");

      // ë©”ì¸ì—ì„œ ì“°ëŠ” ìœ ì € ì •ë³´ í•¨ìˆ˜ ì¬ì‚¬ìš©
      let currentUser = (typeof getCurrentUser === "function") ? getCurrentUser() : null;

      // DOM ìš”ì†Œ ìºì‹œ
      const heroCard = document.querySelector(".hero-card");
      const initialContent = document.querySelector(".hero-content-initial");
      const testSetup = document.querySelector(".test-setup");
      const testResultView = document.querySelector(".test-result");

      const startTestViewBtn = document.getElementById("start-test-view-btn");
      const greetingName = document.getElementById("test-greeting-name");

      const countdownSpan = document.getElementById("test-countdown");
      const timerBigSpan = document.getElementById("test-timer-big");
      const testStartBtn = document.getElementById("test-start-btn");
      const testStopBtn = document.getElementById("test-stop-btn");
      const testOrb = document.getElementById("test-orb");
      const testRunning = document.getElementById("test-running");

      const resultSummaryEl = document.getElementById("test-result-summary");
      const focusPercentEl = document.getElementById("test-focus-percent");
      const idlePercentEl = document.getElementById("test-idle-percent");
      const inputPerMinEl = document.getElementById("test-input-per-min");

      const resultDetailEl = document.getElementById("test-result-detail");
      const resultNicknameEl = document.getElementById("test-result-nickname");
      const resultSelectedTaskEl = document.getElementById("test-result-selected-task");
      const captureCountEl = document.getElementById("test-capture-count");

      const taskConfirmBtn = document.getElementById("task-confirm-btn");

      const activityPieCanvas = document.getElementById("activity-pie");
      const activityTimelineCanvas = document.getElementById("activity-timeline");
      const timerLabel = document.querySelector(".test-timer-label");
      const timerDisplay = document.querySelector(".test-timer-display");

      // ë¼ë²¨ ìˆœì„œ ë° í‘œì‹œ ì´ë¦„
      const LABEL_ORDER = [
        "study",
        "game",
        "webtoon",
        "sns",
        "youtube-ent",
        "youtube-music",
        "other",
      ];

      const LABEL_DISPLAY = {
        study: "Study (ì‘ì—…/ê³µë¶€)",
        game: "Game",
        webtoon: "Webtoon",
        sns: "SNS/ë©”ì‹ ì €",
        "youtube-ent": "YouTube-ì—”í„°",
        "youtube-music": "YouTube-ìŒì•…",
        other: "ê¸°íƒ€",
      };

      // ë‚´ë¶€ ìƒíƒœ
      let selectedTask = null;             // ì‹¤ì œ ì„œë²„ë¡œ ë³´ë‚¼ ë¼ë²¨
      let lastSelectedTask = null;         // ê²°ê³¼ ìš”ì•½ìš©
      let isRunning = false;
      let countdownSeconds = 10;
      let elapsedSeconds = 0;
      let countdownTimerId = null;
      let elapsedTimerId = null;

      let pieChart = null;
      let timelineChart = null;
      let focusTimerId = null;
      let idleTimerId = null;
      let inputTimerId = null;
      let captureTimerId = null;

      // =============================
      // ìœ í‹¸: ë¡œê·¸ì¸ í•„ìš” ëª¨ë‹¬ ì—´ê¸°
      // =============================
      function openLoginRequired() {
        if (typeof openLoginRequiredModal === "function") {
          openLoginRequiredModal();
        } else {
          alert("ë¡œê·¸ì¸ì´ í•„ìš”í•œ ê¸°ëŠ¥ì…ë‹ˆë‹¤. ë¨¼ì € ë¡œê·¸ì¸ í•´ì£¼ì„¸ìš”.");
          window.location.href = "/login.html";
        }
      }
function clearTimers() {
  // íƒ€ì´ë¨¸ ì¸í„°ë²Œ ì œê±°
  if (countdownTimerId) {
    clearInterval(countdownTimerId);
    countdownTimerId = null;
  }

  // 10ì´ˆ(10000ms)ë¡œ ì´ˆê¸°í™”
  countdownSeconds = 10;
  if (countdownSpan) countdownSpan.textContent = "10";
  if (timerBigSpan) timerBigSpan.textContent = "10.00";

  // ê²€ì‚¬ì¤‘ í‘œì‹œ ë„ê¸°
  if (testRunning) {
    testRunning.classList.add("hidden");
  }

  // ë²„íŠ¼ ìƒíƒœ ì´ˆê¸°í™”
  if (testStartBtn) {
    testStartBtn.disabled = false;
    testStartBtn.textContent = "ê²€ì‚¬ ì‹œì‘";
  }

  isRunning = false;
}


      // =============================
      // ìœ í‹¸: ì „ì²´ ê²€ì‚¬ ìƒíƒœ ì´ˆê¸°í™”
      // =============================
      function resetTestStateToInitial() {
        clearTimers();
        selectedTask = null;
        lastSelectedTask = null;

        // ì„ íƒ ë¼ë””ì˜¤ í•´ì œ
        const radios = document.querySelectorAll('input[name="task"]');
        radios.forEach((r) => {
          r.checked = false;
        });

        if (heroCard) {
          heroCard.classList.remove("test-mode", "result-mode");
        }
        if (initialContent) initialContent.classList.remove("hidden");
        if (testSetup) testSetup.classList.add("hidden");
        if (testResultView) testResultView.classList.add("hidden");

        // ì°¨íŠ¸ë„ ì œê±°
        if (pieChart) {
          pieChart.destroy();
          pieChart = null;
        }
        if (timelineChart) {
          timelineChart.destroy();
          timelineChart = null;
        }
      }

      // =============================
      // ì„œë²„ì— ê²€ì‚¬ ì‹œì‘ ì•Œë¦¬ê¸°
      // =============================
      async function notifyServerTestStart(userId, task) {
        const res = await fetch("/api/test/start", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ userId, task }),
        });

        const data = await res.json().catch(() => null);
        if (!res.ok || !data || !data.ok) {
          throw new Error(data?.message || "ê²€ì‚¬ ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
        return data;
      }

      // =============================
      // ì„œë²„ì— ê²€ì‚¬ ì¢…ë£Œ + ë¶„ì„ ìš”ì²­
      // =============================
      async function notifyServerTestStop(userId) {
        const res = await fetch("/api/test/stop", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ userId }),
        });

        const data = await res.json().catch(() => null);
        if (!res.ok || !data || !data.ok) {
          throw new Error(data?.message || "ê²€ì‚¬ ì¢…ë£Œ/ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
        return data;
      }

function startCountdownAndTimer() {
  isRunning = true;

  // 10ì´ˆ = 10000ms, 0.01ì´ˆ ë‹¨ìœ„ë¡œ ì¤„ì—¬ì„œ 10.00 â†’ 0.00 ì• ë‹ˆë©”ì´ì…˜
  let remainingMs = 10000;
  const TICK = 10; // 10ms

  countdownTimerId = setInterval(() => {
    remainingMs -= TICK;
    if (remainingMs < 0) remainingMs = 0;

    const remainSec = remainingMs / 1000;
    const intSec = Math.ceil(remainSec);

    if (countdownSpan) {
      countdownSpan.textContent = intSec.toString();
    }
    if (timerBigSpan) {
      // ğŸ”¥ ì—¬ê¸°ì„œ 10.00 â†’ 0.00 ì²˜ëŸ¼ ë³´ì—¬ì¤Œ
      timerBigSpan.textContent = remainSec.toFixed(2);
    }

    if (remainingMs <= 0) {
      clearInterval(countdownTimerId);
      countdownTimerId = null;

      // ì—¬ê¸°ë¶€í„°ëŠ” "ê²€ì‚¬ì¤‘" UI
      if (timerLabel)   timerLabel.classList.add("hidden");
      if (timerDisplay) timerDisplay.classList.add("hidden");
      if (testRunning)  testRunning.classList.remove("hidden");

      // ì‹¤ì œ ë¡œê·¸ ê¸°ë¡ì€ ì´ë¯¸ ì„œë²„ì—ì„œ ì‹œì‘ëœ ìƒíƒœë‹ˆê¹Œ
      // ë³„ë„ ì¹´ìš´íŠ¸ì—… íƒ€ì´ë¨¸ëŠ” ì•ˆ ëŒë ¤ë„ ë¨
    }
  }, TICK);
}

      // =============================
      // ë¶„ì„ ê²°ê³¼ â†’ ì°¨íŠ¸ìš© íƒ€ì„ë¼ì¸ ë°ì´í„°
      // =============================
      function buildTimelineData(analyze) {
        const windowInfo = analyze?.window || {};
        const winLabels = windowInfo.window_labels || [];
        const totalSec =
          windowInfo.session_duration_sec ||
          analyze?.engagement?.session_duration_sec ||
          0;

        const SEGMENTS = 5;

        if (!winLabels.length || !totalSec) {
          const idx = LABEL_ORDER.indexOf(analyze?.final_label || "other");
          return {
            labels: ["ì „ì²´ êµ¬ê°„"],
            values: [idx >= 0 ? idx : 0],
          };
        }

        const segLabels = [];
        const segValues = [];

        for (let i = 0; i < SEGMENTS; i++) {
          const startIdx = Math.floor((winLabels.length * i) / SEGMENTS);
          const endIdx = Math.max(
            startIdx + 1,
            Math.floor((winLabels.length * (i + 1)) / SEGMENTS)
          );
          const slice = winLabels.slice(startIdx, endIdx);
          if (!slice.length) continue;

          // í•´ë‹¹ êµ¬ê°„ì—ì„œ ê°€ì¥ ë§ì´ ë“±ì¥í•œ ë¼ë²¨
          const counts = {};
          slice.forEach((l) => {
            counts[l] = (counts[l] || 0) + 1;
          });

          let bestLabel = slice[0];
          let bestCount = 0;
          for (const [k, v] of Object.entries(counts)) {
            if (v > bestCount) {
              bestLabel = k;
              bestCount = v;
            }
          }

          const segStartSec = (totalSec * i) / SEGMENTS;
          const segEndSec = (totalSec * (i + 1)) / SEGMENTS;

          let timeLabel;
          if (totalSec >= 60) {
            const startMin = segStartSec / 60;
            const endMin = segEndSec / 60;
            timeLabel = `${startMin.toFixed(1)}~${endMin.toFixed(1)}ë¶„`;
          } else {
            timeLabel = `${Math.round(segStartSec)}~${Math.round(
              segEndSec
            )}ì´ˆ`;
          }

          const idx = LABEL_ORDER.indexOf(bestLabel);
          segLabels.push(timeLabel);
          segValues.push(idx >= 0 ? idx : 0);
        }

        return { labels: segLabels, values: segValues };
      }
      function getUserId(u) {
        return Number(u?.user_id ?? u?.id ?? u?.userId ?? 0);
      }

 

            // =============================
      // ìˆ«ì ì• ë‹ˆë©”ì´ì…˜ (1.00 â†’ ëª©í‘œê°’ê¹Œì§€ ë¹ ë¥´ê²Œ ì¦ê°€)
      // =============================
      function animateNumber(el, target, suffix = "", duration = 600, decimals = 2, type = "focus") {
        if (!el || typeof target !== "number" || isNaN(target)) {
          el.textContent = suffix ? `--${suffix}` : "--";
          return;
        }

        // ì´ì „ íƒ€ì´ë¨¸ ì •ë¦¬
        const clearPrev = () => {
          if (type === "focus" && focusTimerId) {
            clearInterval(focusTimerId);
            focusTimerId = null;
          } else if (type === "idle" && idleTimerId) {
            clearInterval(idleTimerId);
            idleTimerId = null;
          } else if (type === "input" && inputTimerId) {
            clearInterval(inputTimerId);
            inputTimerId = null;
          } else if (type === "capture" && captureTimerId) {
            clearInterval(captureTimerId);
            captureTimerId = null;
          }
        };
        clearPrev();

        const start = 1.0;
        const steps = Math.max(10, Math.floor(duration / 30));
        let step = 0;

        const interval = duration / steps;

        const timerId = setInterval(() => {
          step++;
          const t = step / steps;
          const value = start + (target - start) * t;
          el.textContent = value.toFixed(decimals) + suffix;

          if (step >= steps) {
            clearPrev();
            el.textContent = target.toFixed(decimals) + suffix;
          }
        }, interval);

        if (type === "focus") {
          focusTimerId = timerId;
        } else if (type === "idle") {
          idleTimerId = timerId;
        } else if (type === "input") {
          inputTimerId = timerId;
        } else if (type === "capture") {
          captureTimerId = timerId;
        }
      }

      // =============================
      // ë¶„ì„ ê²°ê³¼ í‘œì‹œ (í…ìŠ¤íŠ¸ + ì°¨íŠ¸)
      // =============================
      function showTestResult(data) {
        if (!data || !data.ok) {
          alert(data?.message || "ë¶„ì„ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
          return;
        }

        const analyze = data.analyzeResult || {};
        const dist =
          (analyze.activity_distribution &&
            analyze.activity_distribution.percent) ||
          {};
        const focusPercent =
          data.focusPercent ?? analyze.focus_percent ?? null;
        const idlePercent =
          data.idlePercent ?? analyze.engagement?.idle_percent ?? null;
        const inputPerMin =
          data.inputPerMin ?? analyze.engagement?.input_per_min ?? null;

        const finalLabel = analyze.final_label || data.predicted || "other";
        const selectedFromServer =
          data.selectedTask || analyze.selected_task || lastSelectedTask;

        const selectedDisplay =
          LABEL_DISPLAY[selectedFromServer] || selectedFromServer || "ì„ íƒ ì•ˆ í•¨";
        const finalDisplay =
          LABEL_DISPLAY[finalLabel] || finalLabel || "ê¸°íƒ€";

                  // ë‹‰ë„¤ì„ (ì¢Œì¸¡ ìƒë‹¨)
        const nickname =
          (typeof getCurrentUser === "function" && getCurrentUser()?.nickname) ||
          currentUser?.nickname ||
          "ì‚¬ìš©ì";

        if (resultNicknameEl) {
          resultNicknameEl.textContent = nickname;
        }

        // ì„ íƒí•œ ì‘ì—… ë¼ë²¨ (ì¢Œì¸¡ ìƒë‹¨ 3ë²ˆì§¸ ì¤„)
        if (resultSelectedTaskEl) {
          resultSelectedTaskEl.textContent = selectedDisplay;
        }


        const sessionSec =
          analyze.engagement?.session_duration_sec ||
          analyze.window?.session_duration_sec ||
          0;
        const sessionMin = sessionSec ? (sessionSec / 60).toFixed(1) : null;

        // ìš”ì•½ ë¬¸ì¥
        // ìš”ì•½ ë¬¸êµ¬
        if (resultSummaryEl) {
          const timeText = sessionMin
            ? `${sessionMin}ë¶„ ë™ì•ˆ`
            : "ì´ë²ˆ ì„¸ì…˜ì—ì„œ";
          resultSummaryEl.textContent =
            `${timeText} ê¸°ë¡í•œ ê²°ê³¼ ${finalDisplay}í™œë™ ê°ì§€`;
        }

        // ì˜¤ë¥¸ìª½ ì°¨íŠ¸ ì•ˆë‚´ ë¬¸êµ¬
        if (resultDetailEl) {
          resultDetailEl.textContent =
            "";
        }

        // ì£¼ìš” ìˆ˜ì¹˜
               // ì§‘ì¤‘ë„ %
        if (focusPercentEl) {
          if (typeof focusPercent === "number") {
            animateNumber(
              focusPercentEl,
              focusPercent,
              "%",
              700,
              2,
              "focus"
            );
          } else {
            focusPercentEl.textContent = "--%";
          }
        }

        // ì ìˆ˜ ì‹œê°„ ë¹„ìœ¨ %
        if (idlePercentEl) {
          if (typeof idlePercent === "number") {
            animateNumber(
              idlePercentEl,
              idlePercent,
              "%",
              700,
              2,
              "idle"
            );
          } else {
            idlePercentEl.textContent = "--%";
          }
        }

        // ì…ë ¥/ë¶„
        if (inputPerMinEl) {
          if (typeof inputPerMin === "number") {
            animateNumber(
              inputPerMinEl,
              inputPerMin,
              "",
              700,
              2,
              "input"
            );
          } else {
            inputPerMinEl.textContent = "--";
          }
        }

        // ê¸°ë¡ëœ í™”ë©´(ì´ ìº¡ì³ ìˆ˜) - analyzerì—ì„œ ìˆ«ìë¥¼ ë„˜ê²¨ì¤€ë‹¤ê³  ê°€ì •
        const captureCount =
          Number(
            analyze.screen?.capture_count ??
              analyze.screen?.num_captures ??
              analyze.screen?.total_captures ??
              0
          ) || 0;

        if (captureCountEl) {
          if (captureCount > 0) {
            animateNumber(
              captureCountEl,
              captureCount,
              "",
              700,
              0,
              "capture"
            );
          } else {
            captureCountEl.textContent = "--";
          }
        }

        // ì¹´ë“œ ëª¨ë“œ ì „í™˜ (ê²°ê³¼ ì „ìš©)
        if (heroCard) {
          heroCard.classList.add("test-mode", "result-mode");
        }
        if (initialContent) initialContent.classList.add("hidden");
        if (testSetup) testSetup.classList.add("hidden");
        if (testResultView) testResultView.classList.remove("hidden");

        // --------- ì›ê·¸ë˜í”„ (í™œë™ ë¹„ìœ¨) ----------
        if (activityPieCanvas) {
          const ctxPie = activityPieCanvas.getContext("2d");
          if (pieChart) {
            pieChart.destroy();
          }

          const pieData = LABEL_ORDER.map((key) => dist[key] ?? 0);
          const pieLabels = LABEL_ORDER.map(
            (key) => LABEL_DISPLAY[key] || key
          );

          pieChart = new Chart(ctxPie, {
            type: "pie",
            data: {
              labels: pieLabels,
              datasets: [
                {
                  data: pieData,
                  backgroundColor: [
                    "#7c4dff", // study
                    "#ff6b6b", // game
                    "#ffb74d", // webtoon
                    "#4dd0e1", // sns
                    "#42a5f5", // youtube-ent
                    "#ab47bc", // youtube-music
                    "#9e9e9e", // other
                  ],
                },
              ],
            },
            options: {
              responsive: true,
              plugins: {
                legend: {
                  position: "bottom",
                  labels: {
                    color: "#f5f5ff",
                    font: { size: 11 },
                  },
                },
              },
            },
          });
        }

        // --------- ì‹œê°„ëŒ€ë³„ í™œë™ ì°¨íŠ¸ ----------
        if (activityTimelineCanvas) {
          const ctxTime = activityTimelineCanvas.getContext("2d");
          if (timelineChart) {
            timelineChart.destroy();
          }

          const tl = buildTimelineData(analyze);

          timelineChart = new Chart(ctxTime, {
            type: "line",
            data: {
              labels: tl.labels,
              datasets: [
                {
                  label: "í™œë™ ìœ í˜•",
                  data: tl.values,
                  borderColor: "#7c4dff",
                  borderWidth: 2,
                  tension: 0.3,
                  pointRadius: 4,
                  pointHoverRadius: 6,
                },
              ],
            },
            options: {
              responsive: true,
              plugins: {
                legend: { display: false },
                tooltip: {
                  callbacks: {
                    label: (ctx) => {
                      const idx = ctx.parsed.y;
                      const key = LABEL_ORDER[idx] || "";
                      const name = LABEL_DISPLAY[key] || key;
                      return name || "";
                    },
                  },
                },
              },
              scales: {
                y: {
                  ticks: {
                    stepSize: 1,
                    callback: (value) => {
                      const key = LABEL_ORDER[value] || "";
                      return LABEL_DISPLAY[key] || "";
                    },
                    color: "#e0e0ff",
                    font: { size: 10 },
                  },
                  suggestedMin: 0,
                  suggestedMax: LABEL_ORDER.length - 1,
                  grid: {
                    color: "rgba(255,255,255,0.06)",
                  },
                },
                x: {
                  ticks: {
                    color: "#e0e0ff",
                    font: { size: 10 },
                  },
                  grid: {
                    color: "rgba(255,255,255,0.04)",
                  },
                },
              },
            },
          });
        }
      }

      // =============================
      // ì´ë²¤íŠ¸ ë°”ì¸ë”©
      // =============================

      // "ê²€ì‚¬í•˜ê¸°" ë²„íŠ¼ â†’ í…ŒìŠ¤íŠ¸ ì„¤ì • í™”ë©´ ì—´ê¸°
      if (startTestViewBtn) {
        startTestViewBtn.addEventListener("click", () => {
          currentUser =
            (typeof getCurrentUser === "function") ? getCurrentUser() : null;

          if (!currentUser) {
            openLoginRequired();
            return;
          }

          if (greetingName) {
            greetingName.textContent = currentUser.nickname || "ì‚¬ìš©ì";
          }

          if (heroCard) {
            heroCard.classList.add("test-mode");
          }
          if (initialContent) initialContent.classList.add("hidden");
          if (testResultView) testResultView.classList.add("hidden");
          if (testSetup) testSetup.classList.remove("hidden");

          clearTimers();
        });
      }

      // ì‘ì—… ì„ íƒ í›„ "ì„ íƒ ì™„ë£Œ"
      if (taskConfirmBtn) {
        taskConfirmBtn.addEventListener("click", () => {
          const checked = document.querySelector(
            'input[name="task"]:checked'
          );
          if (!checked) {
            alert("ë¨¼ì € ì‘ì—…ì„ í•˜ë‚˜ ì„ íƒí•´ì£¼ì„¸ìš”.");
            return;
          }
          selectedTask = checked.value;
          lastSelectedTask = selectedTask;
          alert("ì‘ì—…ì´ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ 'ê²€ì‚¬ ì‹œì‘' ë²„íŠ¼ì„ ëˆŒëŸ¬ ì£¼ì„¸ìš”.");
        });
      }

      // "ê²€ì‚¬ ì‹œì‘"
      if (testStartBtn) {
        testStartBtn.addEventListener("click", async () => {
          if (isRunning) return;

          currentUser =
            (typeof getCurrentUser === "function") ? getCurrentUser() : null;
          if (!currentUser) {
            openLoginRequired();
            return;
          }

          if (!selectedTask) {
            alert("ì‘ì—…ì„ ì„ íƒí•˜ê³  'ì„ íƒ ì™„ë£Œ' ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.");
            return;
          }

          try {
            testStartBtn.disabled = true;
            testStartBtn.textContent = "ì‹œì‘ ì¤‘...";
            const uid = getUserId(currentUser);
            if (!uid) {
              openLoginRequired();
              return;
            }
            await notifyServerTestStart(uid, selectedTask);


            // ì‹œì‘ ì„±ê³µ ì‹œ
            if (testStopBtn) {
              testStopBtn.disabled = false;
            }
            startCountdownAndTimer();
          } catch (err) {
            console.error(err);
            alert(err.message || "ê²€ì‚¬ ì‹œì‘ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            testStartBtn.disabled = false;
          } finally {
            if (!isRunning) {
              testStartBtn.textContent = "ê²€ì‚¬ ì‹œì‘";
            }
          }
        });
      }

      // "ê²€ì‚¬ ì¢…ë£Œ"
      if (testStopBtn) {
        testStopBtn.addEventListener("click", async () => {
          if (!isRunning) return;

          currentUser =
            (typeof getCurrentUser === "function") ? getCurrentUser() : null;
          if (!currentUser) {
            openLoginRequired();
            return;
          }

          try {
            testStopBtn.disabled = true;
            testStopBtn.textContent = "ì¢…ë£Œ ì¤‘...";
            const uid = getUserId(currentUser);
            if (!uid) {
              openLoginRequired();
              return;
            }
            
            
            const data = await notifyServerTestStop(uid);


            clearTimers();
            showTestResult(data);
          } catch (err) {
            console.error(err);
            alert(err.message || "ê²€ì‚¬ ì¢…ë£Œ/ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            testStopBtn.disabled = false;
          } finally {
            isRunning = false;
            testStopBtn.textContent = "ê²€ì‚¬ ì¢…ë£Œ";
          }
        });
      }

      // êµ¬(orb) ë²„íŠ¼ ë™ì‘
      if (testOrb) {
        testOrb.addEventListener("click", () => {
          // ê²€ì‚¬ ì¤‘ì´ë©´ ë¨¼ì € ì¢…ë£Œ ìœ ë„
          if (isRunning) {
            alert("ê²€ì‚¬ ì¤‘ì—ëŠ” ëŒì•„ê°ˆ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\në¨¼ì € 'ê²€ì‚¬ ì¢…ë£Œ'ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.");
            return;
          }

          // ê²°ê³¼ í™”ë©´ì´ ì—´ë ¤ ìˆìœ¼ë©´ â†’ ì´ˆê¸° í™”ë©´ìœ¼ë¡œ
          if (heroCard && heroCard.classList.contains("result-mode")) {
            resetTestStateToInitial();
            return;
          }

          // ê²€ì‚¬ ì„¤ì • í™”ë©´ë§Œ ì—´ë ¤ ìˆìœ¼ë©´ â†’ ì´ˆê¸° í™”ë©´ìœ¼ë¡œ
          if (testSetup && !testSetup.classList.contains("hidden")) {
            resetTestStateToInitial();
            return;
          }

          // ê·¸ ì™¸ì—ëŠ” ë©”ì¸ìœ¼ë¡œ
          window.location.href = "/";
        });
      }

      // í˜ì´ì§€ ë¡œë”© ì‹œ íƒ€ì´ë¨¸/ë²„íŠ¼ ê¸°ë³¸ ìƒíƒœ ì •ë¦¬
      clearTimers();
    });
     document.getElementById("goMyPageBtn")?.addEventListener("click", () => {
    window.location.href = "/mypage.html";
  });
  </script>
</body>
</html>
